Ανδρεάδης Δημοσθένης
Α.Μ. 1115201400321

Εργασία 1

Η εργασία περιλαμβάνει τα εξής αρχεία:
main.c          : Υλοποίηση της main
mainFunctions.c : Συναρτήσεις για τις εντολές που υποβάλλει ο χρήστης
stateList.c     : Συναρτήσεις για τη δομή των χωρών
recordList.c	: Συναρτήσεις για τη δομή των records
bloomFilter.c	: Συναρτήσεις για τα Bloom Filter
skipList.c	: Συναρτήσεις για τις Skip List
structs.h       : Οι δομές της εκφώνησης
functions.h     : Δηλώσεις των συναρτήσεων
Makefile	: Μake και δημιουργία του executable vaccineMonitor
testFile.sh	: Bash script του (Β) σκέλους

Α) Εφαρμογή vaccineMonitor

Έχει γίνει υλοποίηση όλων των δομών που ζητούνται στην εκφώνηση. Χρησιμοποιούνται επιπλέον μια δομή date για την αναπαράσταση των ημερομηνιών, μια συνδεδεμένη λίστα για την τήρηση των χωρών και μια ταξινομημένη συνδεδεμένη λίστα για την κατάχωριση των records.

Ξεκινώντας, το πρόγραμμα διαβάζει κάθε εγγραφή γραμμή-γραμμή από το αρχείο εισόδου, δημιουργώντας παράλληλα:
α.  μια συνδεδεμένη λίστα για την αποθήκευση των χωρών,
β.  μια ταξινομημένη συνδεδεμένη λίστα για την αποθήκευση των εγγραφών, με δείκτη στην αντίστοιχη χώρα. Σε περίπτωση duplicates που είναι valid, γίνεται απλά ενημέρωση της λίστας των virus στην προϋπάρχουσα εγγραφή, για αποφυγή επικάλυψης της πληροφορίας,
γ.  μία λίστα από Bloom Filter, για τις vaccinated εγγραφές,
δ.  δύο ξεχωριστές λίστες από Skip List, για τις vaccinated και τις non vaccinated εγγραφές, με δείκτες στη δομή των records.

Μόλις ολοκληρωθεί η διαδικασία καταγραφής των δεδομένων του αρχείου στις δομές, το πρόγραμμα αναμένει την είσοδο εντολής από τον χρήστη. Ανάλογα με την επιλογή της εντολής, καλούνται οι απαραίτητες συναρτήσεις για την εκτύπωση των σωστών αποτελεσμάτων. Έχει γίνει υλοποίηση όλων των εντολών που ζητούνται και η εκτέλεσή τους έχει δοκιμαστεί σε διάφορές παραλλαγές εισόδου από τον χρήστη.

Για τις εισαγωγές στo bit array των Bloom Filter χρησιμοποιείται ένας int* και οι αναγκαίες bitwise πράξεις. Για τα levels των Skip List χρησιμοποιείται μία λίστα από next pointers, με μέγιστο ύψος της Skip List το ~log(πληθυσμός γής).

Έλεγχοι:
i.   Κατά την είσοδο γίνονται οι εξής:
     - ότι δόθηκε ο ορθός αριθμός ορισμάτων
     - ότι το αρχείο (citizenRecordsFile) που δίνεται ως όρισμα είναι υπαρκτό αρχείο,
     - ότι το μέγεθος (bloomSize) που δίνεται ως όρισμα είναι θετικός αριθμός,

ii.  Κατά την ανάγνωση του αρχείου γίνονται οι εξής:
     - ότι σε ένα record μετά από "NO" δεν υπάρχει ημερομηνία,
     - ότι, σε περίπτωση identical citizenID, όλα τα στοιχεία του record είναι identical, εκτός του virus,
     - αν σε record που είναι identical με άλλο δοθεί ίδιο virus, απορρίπτεται η δεύτερη εγγραφή,
     - αν σε record που είναι identical με άλλο δοθεί νέο virus, αυτό προστίθεται στα viruses του υφιστάμενου record,

iii. Κατά την εκτέλεση των εντολών χρήστη, γίνονται οι εξής έλεγχοι, με εμφάνιση κατάλληλων μηνυμάτων στον χρήστη σε περίπτωση λάθους:
     - ότι δίνεται ο κατάλληλος κάθε φορά αριθμός ορισμάτων,
     - (για τις ανάλογες εντολές) ότι το country ή/και το virus όρισμα που δίνονται αφορούν υπαρκτή χώρα ή ιό,
     - (για τις εντολές καταχώρισης νέου record) ότι το citizenID αποτελείται από ψηφία, το date δίνεται στο σωστό format, το record δεν ειναι incosistent, το record δεν έχει ήδη εμβολιαστεί για τον ιό που δίνεται,

Γίνεται σωστή αποδέσμευση της μνήμης που χρησιμοποιεί η εφαρμογή, με ενδεικτική εκτέλεση:
make
valgrind --track-origins=yes --leak-check=full ./vaccineMonitor -b 100000 -c citizenRecordsFile.txt

Β) Script testFile.sh

i.  Κατά την είσοδο γίνονται οι εξής έλεγχοι:
    - ότι δόθηκε ο ορθός αριθμός παραμέτρων,
    - ότι η πρώτη και η δεύτερη παράμετρος (virusesFile, countriesFile) είναι υπαρκτά αρχεία,
    - ότι η τρίτη παράμετρος (numLines) είναι θετικός αριθμός,
    - ότι η τέταρτη παράμετρος (duplicatesAllowed) είναι ο αριθμός 0 ή 1.

ii. Σε περίπτωση που δοθεί ενεργό το flag duplicatesAllowed, το script παράγει duplicate records σε ποσοστό 2%.

iii.Για να επιτευχθεί η μοναδικότητα των citizenID σε περίπτωση που δεν επιτρέπονται τα duplicates, το script δέχεται ως όρισμα numLines έναν αριθμό < 10000.

iv. Το script δοκιμάστηκε για τον χρόνο εκτέλεσης, με ενδεικτικά αποτελέσματα:
    time ./testFile.sh virusesFile.txt countriesFile.txt 200 1

    real	0m4,265s
    user	0m1,722s
    sys	    0m0,875s

    time ./testFile.sh virusesFile.txt countriesFile.txt 5000 0

    real	2m25,064s
    user	0m53,839s
    sys	    0m30,935s